# Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°

Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³ Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¼
Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÐ¼ `npm i` ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ Ð¿Ð°ÐºÐµÑ‚ `@types/chrome` Ð´Ð»Ñ ÑƒÐ´Ð¾Ð±ÑÑ‚Ð²Ð° Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ñ typescript-Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÐ°Ð¼Ð¸

Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ð°Ñ‚Ñ†Ð¸ÑŽ Ð¥Ñ€Ð¾Ð¼Ð°
https://developer.chrome.com/docs/extensions/reference/

Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ð°Ñ‚Ñ†Ð¸ÑŽ MDN
https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€

# Chrome

1.  ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ chrome://extensions/
2.  Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Developer mode Ð² ÑˆÐ°Ð¿ÐºÐµ
3.  ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÑƒ 'Load unpacked' Ð¸ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð¿Ð°Ð¿ÐºÐµ 'src'

## Firefox

ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ð°ÐºÐµÑ‚ web-ext
`npm install --global web-ext`

Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¸Ð· Ð¿Ð°Ð¿ÐºÐ¸ `src` ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹
`npx web-ext run`

Ð”Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ Ð½Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ¸, Ð¿Ð¾Ð»ÐµÐ·Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ `lint`
_Ð—Ð°Ð¿ÑƒÑÐº Ð¸Ð· ÐºÐ¾Ñ€Ð½Ñ Ð¿Ð°Ð¿ÐºÐ¸ `src`_
`npx web-ext lint`

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¾Ñ‚Ð²ÐµÑ‚Ð°:

```cmd
Validation Summary:

errors          0
notices         0
warnings        0
```

## Safari

ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ ÑƒÑÑ‚Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ XCode ðŸ˜’

Ð˜Ð· ÐºÐ¾Ñ€Ð½Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ

`xcrun safari-web-extension-converter src --project-location ./safari`

Ð’ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²ÑˆÐµÐ¼ÑÑ Ð¾ÐºÐ½Ðµ XCode Ð½Ð°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÑƒ Build.

# Content-script

Js-Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¸Ð½Ð¶ÐµÐºÑ‚ÑÑ‚ÑÑ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹, ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ Ð² `matches` Ð² `manifest.json`.

# Background-script

Background-ÑÐºÑ€Ð¸Ð¿Ñ‚ ÑÐ»ÑƒÐ¶Ð¸Ñ‚ ÑÐ²Ð¾ÐµÐ¾Ð±Ñ€Ð°Ð·Ð½Ñ‹Ð¼ "Ð±ÑÐºÐµÐ½Ð´Ð¾Ð¼" Ð´Ð»Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ Ð¸ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ API, Ñ‡ÐµÐ¼ content-ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹

# Popup

Web-ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¸ Ð½Ð° Ð¸ÐºÐ¾Ð½ÐºÑƒ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð½Ð¾Ð¹ Ð¿Ð°Ð½ÐµÐ»Ð¸. ÐœÐ¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð¸ js-ÑÐºÑ€Ð¸Ð¿Ñ‚Ñ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¼Ð¾Ð³ÑƒÑ‚ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ c background-ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼

# Ð’Ð·Ð°Ð¸Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°Ð¼Ð¸

## Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

Ð’Ð·Ð°Ð¸Ð¼Ð¿Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼ Ð¸ Ð±ÑÐºÐµÐ³Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð¼ Ð¸ Ð¿Ð¾Ð¿Ð°Ð¿-ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼ Ð¸ Ð±ÑÐºÐ³Ñ€Ð°ÑƒÐ½Ð´Ð¾Ð¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ.

1. ÐŸÐ¾ÑÑ‹Ð»Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÑŽ
2. ÐŸÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»Ñ
3. Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÐµÐ»ÑŽ ÐºÐ¾Ð»Ð±ÑÐº (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

```js
chrome.runtime.sendMessage({ action: "action-name" }, (responseData) => {
  //callback code
  console.log(responseData);
});
```

```js
chrome.runtime.onMessage.addListener((req, info, cb) => {
  if (req.action === "action-name") {
    cb(some_data);
  }
});
```

```js
//console.log(responseData)
```

## ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹

ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð¾Ð¿Ð¸ÑÐ°Ð½Ñ‹ Ð² `commands` Ð² `manifest.json` Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ background-ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð¼.

```js
chrome.commands.onCommand.addListener((command, tab) => {
  if (command === "command_name") {
    //Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÑÐ»ÐµÐ¼ ÑÐ¾Ð¾Ñ‰ÐµÐ½Ð¸Ðµ content-ÑÐºÑ€Ð¸Ð¿Ñ‚Ñƒ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰ÐµÐ¼Ñƒ Ð²Ð¾ Ð²ÐºÐ»Ð°Ð´ÐºÐµ, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð±Ñ‹Ð»Ð° Ð²Ñ‹Ð·Ð²Ð°Ð½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°
    chrome.tabs.sendMessage(
      tab.id,
      { action: "command runned" },
      (response) => {
        //console.log(response)
      }
    );
  }
});
```
